//海洋主题的动态装扮 define(function(require, exports, module){    var $ = require('jquery'),        html = [            '<div class="layout-dynamic">',                '<div class="layout-dynmic-inner">',                    '<div class="dy-item dy-1"></div>',                    '<div class="dy-item dy-2"></div>',                    '<div class="dy-item dy-3"></div>',                    //'<div class="dy-item dy-4"></div>',                    '<div class="dy-item dy-5"></div>',                    '<div class="dy-bubble">',                         '<span class="dy-bubble-item dy-bubble-item-1"></span>',                         '<span class="dy-bubble-item dy-bubble-item-2"></span>',                         '<span class="dy-bubble-item dy-bubble-item-3"></span>',                         '<span class="dy-bubble-item dy-bubble-item-4"></span>',                         // '<span class="dy-bubble-item dy-bubble-item-5"></span>',                         // '<span class="dy-bubble-item dy-bubble-item-6"></span>',                         // '<span class="dy-bubble-item dy-bubble-item-7"></span>',                    '</div>',                    '<div class="dy-cloud">',                         '<span class="dy-cloud-item dy-cloud-item-1"></span>',                         '<span class="dy-cloud-item dy-cloud-item-2"></span>',                        // '<span class="dy-cloud-item dy-cloud-item-3"></span>',                         '<span class="dy-cloud-item dy-cloud-item-4"></span>',                    '</div>',                    '<div class="dy-fish">',                    '</div>',                '</div>',            '</div>'];    var support = "onwheel" in document.createElement("div") ? "wheel" : // Modern browsers support "wheel"              document.onmousewheel !== undefined ? "mousewheel" : // Webkit and IE support at least "mousewheel"              "DOMMouseScroll"; // let's assume that remaining browsers are older Firefox    //随机的鱼    var fish_data=[                    {file:'a',pos:[[-126,0],[-126,-54],[-126,-108]],width:91,height:53,direction:1,stepW:1.2,stepH:0.01},            {file:'b',pos:[[-126,-162],[-126,-209],[-126,-256]],width:81,height:46,direction:1,stepW:1.1,stepH:-0.02},            {file:'c',pos:[[-208,-162],[-208,-207],[-208,-252]],width:76,height:44,direction:1,stepW:1.1,stepH:-0.02},            {file:'e',pos:[[-285,-132],[-285,-166],[-285,-200]],width:56,height:33,direction:0,stepW:1.3,stepH:0.05},            {file:'f',pos:[[-218,-132],[-285,-234],[-285,-264]],width:51,height:29,direction:0,stepW:1.2,stepH:0.02},            {file:'g',pos:[[-289,0],[-289,-29],[-289,-58]],width:51,height:28,direction:0,stepW:1.2,stepH:0.02},            {file:'h',pos:[[-218,-44],[-218,-88],[-218,-0]],width:70,height:43,direction:0,stepW:1.2,stepH:0.02}            ];      var setTimeoutMS=45000;      var theme_dynamic_obj={        init:function(itemno){            //var baseURL = 'http://' + window.iiDomain +"/qzone/space_item/orig/"+itemno % 16+ "/" + itemno + '/';            if($.ua.ie < 10)return;                        //wheel scroll resize            if(window.addEventListener){                window.addEventListener(support, theme_dynamic_obj.handleMouseWheel, false);            }else{                document.onmousewheel = theme_dynamic_obj.handleMouseWheel;            }            $(window).scroll(theme_dynamic_obj.handleScroll);            $(window).resize(theme_dynamic_obj.resize);            var bsWidth=$(window).width();            var bsHeight=$(window).height();            //动画逻辑代码开始            var mainWidth=900;            theme_dynamic_obj.resize();            //随机设置泡泡的位置            var bsWidth=document.documentElement.clientWidth || document.body.clientWidth;            var mainWidth=900;            $('.dy-bubble .dy-bubble-item').each(function(){                var _x=Math.random()*bsWidth;//bsWidth/2 + (Math.random()*900/2)*(Math.random()>0.5?1:-1);                var _y=Math.random()*(bsHeight-390)+390                $(this).css({'left':_x+'px','top':_y+'px'});            });                       theme_dynamic_obj.fishCreate();            setTimeout(theme_dynamic_obj.fishCreate,3000);            setTimeout(theme_dynamic_obj.fishCreate,5000);                    },                fishCreate:function(){            var setTimeoutMs=0;           // $.each(fish_data,function(key1,fish_group){            var fish_index=Math.floor(fish_data.length*Math.random());            if(fish_index>=fish_data.length)fish_index=fish_data.length-1;            var  fish_item=fish_data[fish_index];                                            var fish = document.createElement("i");                        fish.id = "fish0";                        fish.style.zIndex = "17";                        fish.style.width = fish_item.width + "px";                        fish.style.height = fish_item.height+ "px";                        //设置位置                        var _top=Math.floor(Math.random()*(bsHeight-400))+400;                        fish._top=_top;                        fish._topStart=_top;                                      fish.style.top = _top+"px";                                                $('.dy-fish').append(fish);                        var fish_frame=0;                    fish.timer=setInterval(function(){                        fish_frame++;                        if(fish_frame>fish_item.pos.length-1)fish_frame=0;                        fish.style.backgroundPosition=fish_item.pos[fish_frame][0]+"px "+fish_item.pos[fish_frame][1]+"px";                    },300);                    //游动                    theme_dynamic_obj.fishAnimationInit(fish_item,fish);                           },        fishAnimationInit:function(fish_item,fish){             if(fish_item.direction==0){                    fish.style.left=-100+"px";                                        setTimeout(function(){                        fish.style.left=(bsWidth+100)+"px";                    },500)                }               else {                    fish.style.left=(bsWidth+100)+"px";                                        setTimeout(function(){                        fish.style.left=-100+"px";                    },500)                }                setTimeout(function(){                    clearInterval(fish.timer);                    fish.parentNode.removeChild(fish);                    theme_dynamic_obj.fishCreate()                },setTimeoutMS);        },        resize:function(){            bsWidth=$(window).width();            bsHeight=$(window).height();            if(bsWidth<=1366){                if(bsHeight<700){                    $('.layout-dynamic .dy-2').css({'position':'absolute','top':'340px','bottom':'auto'});                }                else{                    $('.layout-dynamic .dy-2').css({'position':'fixed','top':'auto','bottom':'0'});                }            }            else if(bsHeight<800){                $('.layout-dynamic .dy-2').css({'position':'absolute','top':'400px','bottom':'auto'});            }            else{                $('.layout-dynamic .dy-2').css({'position':'fixed','top':'auto','bottom':'0'});            }        },        handleMouseWheel:function(e){            theme_dynamic_obj.handleScroll();            return;        },        handleScroll:function(){            return;            if($.ua.ie<10)return;            var scrollTop= $(window).scrollTop() ;            //设置背景色渐变            var colorInit=[18,155,255];            var colorStep=0.06;            var colorR=Math.max(Math.floor(colorInit[0]-scrollTop*colorStep),0)  ;            var colorG=Math.max(Math.floor(colorInit[1]-scrollTop*colorStep),0)  ;            var colorB=Math.max(Math.floor(colorInit[2]-scrollTop*colorStep),0)  ;            $('.layout-dynamic .dy-4').css('background','rgb('+colorR+','+colorG+','+colorB+')');                    },        remove : function(){            //wheel            if(window.removeEventListener){                window.removeEventListener(support, theme_dynamic_obj.handleMouseWheel, false);            }else{                document.onmousewheel = null;            }                        //scroll            $(window).unbind('scroll', theme_dynamic_obj.handleScroll);            //resize            $(window).unbind('resize', theme_dynamic_obj.resize);        }    }        var render = function(itemno){        //插入样式//      $(document.head).append('<link id="dynamicStyle" rev="stylesheet" rel="stylesheet" type="text/css" media="screen" href="http://'+window.siDomain+'/qzone/v8/dress/dynamic/91732/style.css" />');        $('#layBackground').append(html.join(''));        theme_dynamic_obj.init(itemno);        /*移除之前的背景        window.setTimeout(function(){            $('#layBackground').css('background', 'none');        }, 50);        */    };    var remove = function(){        $('.layout-dynamic').remove();        //$('#dynamicStyle').remove();        theme_dynamic_obj.remove();    };    exports.render = render;    exports.remove = remove;});